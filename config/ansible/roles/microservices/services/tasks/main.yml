---
- name: Download services repository
  git:
    repo: https://github.com/DigitalState/Services.git
    version: '{{ services_repository_version }}'
    dest: '{{ services_repository_directory }}'

- name: Start services container
  shell: 'docker-compose -f {{ services_repository_directory }}/docker-compose.yml up -d'
  register: output
  changed_when: output.stderr != '%s_db_1 is up-to-date\n%s_php_1 is up-to-date\n%s_nginx_1 is up-to-date'.replace('%s', services_repository_directory|basename)
