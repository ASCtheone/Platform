---
- name: Download identities repository
  git:
    repo: https://github.com/DigitalState/Identities.git
    version: '{{ identities_repository_version }}'
    dest: '{{ identities_repository_directory }}'

- name: Start identities container
  shell: 'docker-compose -f {{ identities_repository_directory }}/docker-compose.yml up -d'
  register: output
  changed_when: output.stderr != '%s_db_1 is up-to-date\n%s_php_1 is up-to-date\n%s_nginx_1 is up-to-date'.replace('%s', identities_repository_directory|basename)
